Para el segundo compensador solicitado, con el fin de cumplir la condición de que el error en estado estacionario sea cero, necesitamos que la función de transferencia de lazo abierto sea de tipo 1. Sin embargo, la planta original es de tipo 0, lo cual nos obliga a colocar un polo en $z=1$.

Como primer intento, buscamos un cero que, junto con el polo en $z=1$, compense el ángulo faltante de manera similar al diseño del primer compensador. Para ello desarrollamos la Ec.~\eqref{eq:zc2}:

\begin{equation}
	\label{eq:zc2}
	z_c
	= p_c \;-\;
	\frac{
		\sin(\pi + \phi)\;
		\sqrt{(x - p_c)^2 + y^2}
	}{
		\sin\!\Bigl(
		-\arcsin\!\Bigl(\frac{y}{\sqrt{(x - p_c)^2 + y^2}}\Bigr)\;-\;\phi
		\Bigr)
	}.
\end{equation}

Inicialmente este enfoque parece prometedor: podemos calcularlo (valores obtenidos) y, utilizando \textsc{Matlab}, obtener la ganancia $K$ correspondiente (véase Fig.~\ref{fig:rlocusC2}).

\insertarfigura{./Img/lugarDeRaicesCompensador2_completo.png}
{Lugar de raíces de la planta compensada con un filtro \emph{lag} de primer orden y polo en $z=1$.}
{fig:rlocusC2}{1}

\insertarfigura{./Img/lugarDeRaicesCompensador2_zoom.png}
{Lugar de raíces de la planta compensada con un filtro \emph{lag} de primer orden y polo en $z=1$ (detalle ampliado).}
{fig:rlocusC2_zoom}{1}

No obstante, al observar la respuesta al escalón nos encontramos con una decepción: se obtiene un sobrepico del $20\%$, equivalente a un $\zeta \approx 0.4$, lo que no satisface las condiciones deseadas.

\insertarfigura{./Img/StepCompensador2.png}
{Respuesta al escalón del primer intento de compensador.}
{fig:StepCompensador2}{1}

\insertarfigura{./Img/step_y_esfuerzoCompensador2.png}
{Respuesta al escal\'on del sistema en lazo cerrado con el segundo compensador dise\~nado, junto con el esfuerzo de control aplicado por el compensador.}
{ref:stepYEsfuerzoC2_v1}{1}

Esto ocurre porque la ubicación de los polos del sistema final no presenta un par de polos dominantes, por lo que la aproximación de segundo orden utilizada al inicio no resulta válida.

Finalmente, optamos por un compensador de segundo orden. En primer lugar, colocamos nuevamente el polo en $z=1$, pero esta vez anulamos el polo más cercano de la planta (el más lento) y calculamos su contribución a la compensación (valores).

A continuación, diseñamos un segundo compensador para completar lo faltante, anulando el polo más rápido de la planta con un cero en esa ubicación y hallando el nuevo polo mediante el mismo procedimiento aplicado en el primer compensador.

Determinando la ganancia $K$ como en el caso anterior, obtenemos el siguiente resultado, el cual ahora cumple con las condiciones deseadas:

\insertarfigura{./Img/lugarDeRaicesCompensador3_completo.png}
{Lugar de raíces de la planta compensada con un filtro \emph{lag} de segundo orden y polo en $z=1$.}
{fig:rlocusC3}{1}

\insertarfigura{./Img/lugarDeRaicesCompensador3_zoom.png}
{Lugar de raíces de la planta compensada con un filtro \emph{lag} de segundo orden y polo en $z=1$ (detalle ampliado).}
{fig:rlocusC3_zoom}{1}

\insertarfigura{./Img/StepCompensador3.png}
{Respuesta al escalón con el tercer compensador propuesto.}
{fig:StepCompensador2}{1}

\insertarfigura{./Img/step_y_esfuerzoCompensador3.png}
{Respuesta al escal\'on del sistema en lazo cerrado con el tercer compensador dise\~nado, junto con el esfuerzo de control aplicado por el compensador.}
{ref:stepYEsfuerzoC3_v1}{1}

\balance
